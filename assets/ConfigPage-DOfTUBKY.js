import{d as Z,r as a,ad as H,ae as Q,j as e,af as X,ag as G,ah as J,y as P,u as Y,a as q,b as ee,N as te,L as B,B as se,z as _,ai as ie,Z as ne,P as ae}from"./index-BFEWtwhJ.js";import{c as A,C as re}from"./configService-D_rl3Y87.js";import{u as ce,T as oe}from"./TimeInput-BnbwFigf.js";import{A as de}from"./arrow-left-Bsa-NHBD.js";import{S as I}from"./settings-DTIwOClu.js";import{S as le}from"./save-CToUh0ov.js";import{T as U,a as ue}from"./tv-hB4auxPZ.js";import{T as M}from"./tag-Bs9kkiC0.js";import{C as xe}from"./chevron-right-DVovX0bV.js";import{G as me}from"./globe-D8FC7nwy.js";import{C as he}from"./circle-check-big-DsCc5FBF.js";import{L as pe}from"./layers-qYC9K1Me.js";import{S as be}from"./search-Caa-NJMl.js";import{P as fe,T as ge}from"./trash-2-DeAKwTRc.js";import{L as ke}from"./layout-grid-B3vlPxs7.js";const ve=[["rect",{width:"18",height:"7",x:"3",y:"3",rx:"1",key:"f1a2em"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}]],je=Z("layout-panel-top",ve),ze=()=>{const[i,d]=a.useState(!0),[h,n]=a.useState({leagues:[],channels:[],cdnOptions:[],ticketSync:{autoSync:!1,syncTime:"08:00",lastSync:null}}),[r,c]=a.useState({types:[],statuses:[],severities:[],categories:[],subCategories:[]}),[x,p]=a.useState([]),[m,y]=a.useState([]);return a.useEffect(()=>{const b=A.subscribeConfigs(u=>{n(w=>({...w,...u}))}),v=A.subscribeTicketOptions(c),j=A.subscribeTeam(p),z=A.subscribeProjects(y);return setTimeout(()=>d(!1),0),()=>{b(),v(),j(),z()}},[]),{configs:h,setConfigs:n,ticketOptions:r,setTicketOptions:c,team:x,setTeam:p,projects:m,setProjects:y,loading:i}};function ye(i){const d=a.useRef({value:i,previous:i});return a.useMemo(()=>(d.current.value!==i&&(d.current.previous=d.current.value,d.current.value=i),d.current.previous),[i])}var R="Switch",[we]=X(R),[Ne,Se]=we(R),F=a.forwardRef((i,d)=>{const{__scopeSwitch:h,name:n,checked:r,defaultChecked:c,required:x,disabled:p,value:m="on",onCheckedChange:y,form:b,...v}=i,[j,z]=a.useState(null),u=H(d,t=>z(t)),w=a.useRef(!1),l=j?b||!!j.closest("form"):!0,[f,o]=Q({prop:r,defaultProp:c??!1,onChange:y,caller:R});return e.jsxs(Ne,{scope:h,checked:f,disabled:p,children:[e.jsx(G.button,{type:"button",role:"switch","aria-checked":f,"aria-required":x,"data-state":W(f),"data-disabled":p?"":void 0,disabled:p,value:m,...v,ref:u,onClick:J(i.onClick,t=>{o(g=>!g),l&&(w.current=t.isPropagationStopped(),w.current||t.stopPropagation())})}),l&&e.jsx(V,{control:j,bubbles:!w.current,name:n,value:m,checked:f,required:x,disabled:p,form:b,style:{transform:"translateX(-100%)"}})]})});F.displayName=R;var $="SwitchThumb",K=a.forwardRef((i,d)=>{const{__scopeSwitch:h,...n}=i,r=Se($,h);return e.jsx(G.span,{"data-state":W(r.checked),"data-disabled":r.disabled?"":void 0,...n,ref:d})});K.displayName=$;var Ce="SwitchBubbleInput",V=a.forwardRef(({__scopeSwitch:i,control:d,checked:h,bubbles:n=!0,...r},c)=>{const x=a.useRef(null),p=H(x,c),m=ye(h),y=ce(d);return a.useEffect(()=>{const b=x.current;if(!b)return;const v=window.HTMLInputElement.prototype,z=Object.getOwnPropertyDescriptor(v,"checked").set;if(m!==h&&z){const u=new Event("click",{bubbles:n});z.call(b,h),b.dispatchEvent(u)}},[m,h,n]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:h,...r,tabIndex:-1,ref:p,style:{...r.style,...y,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});V.displayName=Ce;function W(i){return i?"checked":"unchecked"}var Te=F,Pe=K;function De({className:i,...d}){return e.jsx(Te,{"data-slot":"switch",className:P("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",i),...d,children:e.jsx(Pe,{"data-slot":"switch-thumb",className:P("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}const S=a.memo(({items:i=[],onAdd:d,onRemove:h,onUpdate:n,canEdit:r,title:c,icon:x,placeholder:p="Search or Add..."})=>{const[m,y]=a.useState(""),[b,v]=a.useState(null),[j,z]=a.useState(""),{toast:u}=q(),w=a.useMemo(()=>{if(!m)return i.map((t,g)=>({item:t,idx:g}));const o=m.toLowerCase();return i.map((t,g)=>({item:t,idx:g})).filter(({item:t})=>(typeof t=="string"?t:t.label).toLowerCase().includes(o))},[i,m]),l=()=>{const o=m.trim();if(o){if(i.some(t=>(typeof t=="string"?t:t.label).toLowerCase()===o.toLowerCase())){u({variant:"destructive",title:"Duplicate",description:`"${o}" already exists.`});return}d(o),y("")}},f=o=>{const t=j.trim();if(t&&t!==i[o]){if(i.some((g,D)=>D!==o&&(typeof g=="string"?g:g.label).toLowerCase()===t.toLowerCase())){u({variant:"destructive",title:"Duplicate",description:`"${t}" already exists.`});return}n(o,t)}v(null)};return e.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"shrink-0 p-4 border-b border-zinc-100 dark:border-zinc-800 bg-zinc-50/50 dark:bg-zinc-900/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"p-2 bg-white dark:bg-zinc-800 border border-zinc-100 dark:border-zinc-700 rounded-lg shadow-sm",children:e.jsx(x,{size:16,className:"text-zinc-600 dark:text-zinc-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-zinc-900 dark:text-zinc-100 uppercase tracking-wide",children:c}),e.jsxs("p",{className:"text-[10px] font-medium text-zinc-400",children:[i.length," Records"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1 group",children:[e.jsx(be,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-zinc-400 group-focus-within:text-[#0078D4] transition-colors"}),e.jsx("input",{value:m,onChange:o=>y(o.target.value),onKeyDown:o=>o.key==="Enter"&&r&&l(),placeholder:p,className:"w-full bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-md pl-9 pr-3 py-2 text-xs font-medium outline-none focus:border-[#0078D4] focus:ring-1 focus:ring-[#0078D4] transition-all placeholder:font-medium"})]}),r&&e.jsx("button",{onClick:l,disabled:!m.trim(),className:"px-3 bg-zinc-900 dark:bg-white text-white dark:text-black rounded-md hover:bg-zinc-800 dark:hover:bg-zinc-200 disabled:opacity-50 transition-colors",children:e.jsx(fe,{size:16})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-2 space-y-1",children:w.length>0?w.map(({item:o,idx:t})=>{const g=b===t,D=typeof o=="string"?o:o.label;return e.jsxs("div",{className:"group flex items-center justify-between px-3 py-2 rounded-md hover:bg-zinc-50 dark:hover:bg-zinc-800/50 border border-transparent hover:border-zinc-100 dark:hover:border-zinc-800 transition-all",children:[g?e.jsx("input",{autoFocus:!0,value:j,onChange:s=>z(s.target.value),onBlur:()=>f(t),onKeyDown:s=>{s.key==="Enter"&&f(t),s.key==="Escape"&&v(null)},className:"flex-1 bg-transparent text-xs font-semibold text-[#0078D4] dark:text-[#0078D4] outline-none"}):e.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[e.jsx("span",{className:"text-[10px] font-mono text-zinc-300 dark:text-zinc-600 w-6 shrink-0",children:String(t+1).padStart(2,"0")}),e.jsx("span",{onClick:()=>{r&&(v(t),z(D))},className:P("text-xs font-medium truncate cursor-pointer select-none text-zinc-600 dark:text-zinc-300",r&&"hover:text-[#0078D4] dark:hover:text-[#0078D4]"),children:D})]}),r&&!g&&e.jsx("button",{onClick:()=>h(t),className:"opacity-0 group-hover:opacity-100 p-1.5 text-zinc-300 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md transition-all",children:e.jsx(ge,{size:12})})]},t)}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-zinc-300 dark:text-zinc-700 opacity-60",children:[e.jsx(ke,{size:32,strokeWidth:1,className:"mb-2"}),e.jsx("span",{className:"text-xs font-medium",children:"No items found"})]})})]})});function Ke(){const i=Y(),{toast:d}=q(),{currentUser:h}=ee(),{configs:n,setConfigs:r,ticketOptions:c,setTicketOptions:x,projects:p,setProjects:m,loading:y}=ze(),[b,v]=a.useState(!1),[j,z]=a.useState(!1),[u,w]=a.useState("broadcast"),l=te(h,[ae.LEAD]),f=a.useCallback(()=>z(!0),[]),o=async()=>{if(l){v(!0);try{await Promise.all([A.updateConfigs(n),A.updateTicketOptions(c),A.updateProjects(p)]),d({title:"Deployed",description:"Changes synced successfully.",className:"bg-emerald-500 text-white border-none font-bold"}),z(!1)}catch(s){d({variant:"destructive",title:"Failed",description:s.message})}finally{v(!1)}}},t=(s,k,C)=>({onAdd:T=>{f(),k(N=>C?{...N,[C]:[...N[C],T]}:[...N,T])},onRemove:T=>{f(),k(N=>C?{...N,[C]:N[C].filter((E,L)=>L!==T)}:N.filter((E,L)=>L!==T))},onUpdate:(T,N)=>{f(),k(E=>C?{...E,[C]:E[C].map((L,O)=>O===T?N:L)}:E.map((L,O)=>O===T?N:L))}}),g={onAdd:s=>{f(),r(k=>({...k,cdnOptions:[...k.cdnOptions,{id:s,label:s,color:"bg-zinc-500"}]}))},onRemove:t(n,r,"cdnOptions").onRemove,onUpdate:(s,k)=>{}};if(y)return e.jsx("div",{className:"h-screen flex items-center justify-center",children:e.jsx(B,{className:"animate-spin text-zinc-400"})});const D=[{id:"broadcast",label:"Broadcast",icon:U,desc:"Channels, Leagues, CDN"},{id:"tickets",label:"Ticketing",icon:M,desc:"Types, Severity, Status"},{id:"org",label:"Organization",icon:_,desc:"Projects, Teams"},{id:"system",label:"System",icon:I,desc:"Sync, Preferences"}];return e.jsxs("div",{className:"h-screen bg-zinc-50 dark:bg-black flex flex-col overflow-hidden",children:[e.jsxs("header",{className:"shrink-0 h-14 bg-white dark:bg-zinc-950 border-b border-zinc-200 dark:border-zinc-800 flex items-center justify-between px-4 z-40",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>i(-1),className:"p-2 -ml-2 rounded-lg hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors",children:e.jsx(de,{size:18,className:"text-zinc-500"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-zinc-900 dark:bg-white rounded-lg flex items-center justify-center text-white dark:text-black",children:e.jsx(I,{size:16})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-sm font-bold uppercase tracking-wide text-zinc-900 dark:text-white leading-none",children:"Registry Hub"}),e.jsxs("span",{className:"text-[10px] font-medium text-zinc-400 uppercase tracking-widest",children:[n.leagues?.length+n.channels?.length||0," Records"]})]})]})]}),l&&e.jsxs(se,{onClick:o,disabled:!j||b,className:P("h-9 rounded-md px-6 font-semibold uppercase text-[10px] tracking-widest transition-all",j?"bg-[#0078D4] hover:bg-[#106EBE] text-white shadow-sm":"bg-zinc-100 dark:bg-zinc-800 text-zinc-400"),children:[b?e.jsx(B,{size:14,className:"animate-spin mr-2"}):e.jsx(le,{size:14,className:"mr-2"}),b?"Saving...":"Commit Changes"]})]}),e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsxs("nav",{className:"w-64 shrink-0 bg-white dark:bg-zinc-950 border-r border-zinc-200 dark:border-zinc-800 flex flex-col py-4 overflow-y-auto hidden md:flex",children:[e.jsx("div",{className:"px-4 mb-2 text-[10px] font-semibold text-zinc-400 tracking-widest",children:"Domains"}),e.jsx("div",{className:"space-y-1 px-2",children:D.map(s=>e.jsxs("button",{onClick:()=>w(s.id),className:P("w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-left transition-all",u===s.id?"bg-[#eff6fc] dark:bg-[#0078D4]/20 text-[#0078D4] dark:text-[#0078D4] shadow-sm font-semibold":"text-zinc-600 dark:text-zinc-400 hover:bg-zinc-100 dark:hover:bg-zinc-800 hover:text-zinc-900 dark:hover:text-zinc-200"),children:[e.jsx("div",{className:P("p-1.5 rounded-md",u===s.id?"bg-white dark:bg-zinc-900 shadow-sm text-[#0078D4]":"text-zinc-400 dark:text-zinc-500"),children:e.jsx(s.icon,{size:16})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-bold uppercase tracking-wide leading-none mb-0.5",children:s.label}),e.jsx("div",{className:"text-[9px] font-medium opacity-70",children:s.desc})]}),u===s.id&&e.jsx(xe,{size:14,className:"ml-auto text-[#0078D4]"})]},s.id))})]}),e.jsx("main",{className:"flex-1 overflow-hidden bg-zinc-50/50 dark:bg-black/50 p-4 md:p-6",children:e.jsxs("div",{className:"h-full w-full max-w-7xl mx-auto animate-in fade-in slide-in-from-bottom-4 duration-500",children:[u==="broadcast"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 h-full",children:[e.jsx(S,{title:"Leagues",icon:ue,items:n.leagues,...t(n,r,"leagues"),canEdit:l}),e.jsx(S,{title:"Channels",icon:U,items:n.channels,...t(n,r,"channels"),canEdit:l,placeholder:"Add Channel..."}),e.jsx(S,{title:"CDN Providers",icon:me,items:n.cdnOptions,...g,canEdit:l,placeholder:"Add Provider..."})]}),u==="tickets"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4 h-full",children:[e.jsx(S,{title:"Types",icon:M,items:c.types,...t(c,x,"types"),canEdit:l}),e.jsx(S,{title:"Status",icon:he,items:c.statuses,...t(c,x,"statuses"),canEdit:l}),e.jsx(S,{title:"Severity",icon:ie,items:c.severities,...t(c,x,"severities"),canEdit:l}),e.jsx(S,{title:"Category",icon:pe,items:c.categories,...t(c,x,"categories"),canEdit:l})]}),u==="org"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 h-full items-start",children:[e.jsx("div",{className:"lg:col-span-1 h-full flex flex-col gap-4",children:e.jsx(S,{title:"Projects / Tenants",icon:je,items:p,...t(p,m),canEdit:l})}),e.jsxs("div",{className:"lg:col-span-2 h-full grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(S,{title:"Responsibility Options",icon:_,items:c.responsibilities||[],...t(c,x,"responsibilities"),canEdit:l,placeholder:"Add Name..."}),e.jsx(S,{title:"Assignee Options",icon:_,items:c.assignees||[],...t(c,x,"assignees"),canEdit:l,placeholder:"Add Assignee..."})]})]}),u==="system"&&e.jsx("div",{className:"max-w-2xl mx-auto h-full overflow-y-auto",children:e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-zinc-200 dark:border-zinc-800 bg-zinc-50/80 dark:bg-zinc-900/80 flex items-center gap-3",children:[e.jsx(ne,{size:18,className:"text-[#0078D4]"}),e.jsx("h3",{className:"text-sm font-bold uppercase tracking-wide text-zinc-700 dark:text-zinc-200",children:"Automated Sync"})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-zinc-900 dark:text-white",children:"Google Sheet Sync"}),e.jsx("div",{className:"text-xs text-zinc-500 mt-1",children:"Automatically fetch ticket data daily."})]}),e.jsx(De,{checked:n.ticketSync?.autoSync,onCheckedChange:s=>{f(),r(k=>({...k,ticketSync:{...k.ticketSync,autoSync:s}}))},disabled:!l,className:"data-[state=checked]:bg-[#0078D4]"})]}),n.ticketSync?.autoSync&&e.jsxs("div",{className:"flex items-center justify-between p-4 bg-zinc-50 dark:bg-zinc-800/50 rounded-lg border border-zinc-100 dark:border-zinc-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(re,{size:16,className:"text-zinc-400"}),e.jsx("span",{className:"text-xs font-bold uppercase text-zinc-600 dark:text-zinc-300",children:"Schedule Time"})]}),e.jsx(oe,{value:n.ticketSync?.syncTime||"08:00",onChange:s=>{f(),r(k=>({...k,ticketSync:{...k.ticketSync,syncTime:s.target.value}}))},className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 rounded-md px-2 py-1 text-xs font-bold outline-none w-[100px] focus:border-[#0078D4]"})]})]})]})})]})})]}),e.jsx("div",{className:"md:hidden shrink-0 bg-white dark:bg-zinc-950 border-t border-zinc-200 dark:border-zinc-800 p-2 flex justify-between",children:D.map(s=>e.jsxs("button",{onClick:()=>w(s.id),className:P("flex flex-col items-center justify-center p-2 rounded-md transition-all flex-1",u===s.id?"text-[#0078D4] dark:text-white bg-zinc-50 dark:bg-zinc-900":"text-zinc-400"),children:[e.jsx(s.icon,{size:20,className:P("mb-1",u===s.id&&"fill-current opacity-20")}),e.jsx("span",{className:"text-[9px] font-medium",children:s.label.split(" ")[0]})]},s.id))})]})}export{Ke as default};
