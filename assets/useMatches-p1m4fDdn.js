import{e as M,r as m,aj as T,f as p,h as E,q as f,w as S,g as d,l as A,ac as D}from"./index-Q34mk0jU.js";import{c as _,t as L,a as g,i as H,f as F}from"./format-_IVVRDDj.js";import{u as O,Q as k}from"./useBaseQuery-DdGex9By.js";const w=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],N=M("file-spreadsheet",w);function C(a,o){return O(a,k)}function q(a,o,e){return _(a,+L(a)+o)}function Q(a,o,e){return q(a,o*g)}const y={MATCHES_AUTO:1e3*30,MATCHES_STALE_AUTO:1e3*20,MATCHES_STALE_DEFAULT:1e3*60*5},b={SOON_MINUTES:15},I=async({queryKey:a})=>{const[o,{dateFilter:e,dateRange:c,limit:l}]=a,s=p(E,"schedules");let r;try{if(e){let n=e;if(e instanceof Date)if(H(e))n=F(e,"yyyy-MM-dd");else return[];r=f(s,S("startDate","==",n),d("startTime","asc"))}else c?.start&&c?.end?r=f(s,S("startDate",">=",c.start),S("startDate","<=",c.end),d("startDate","asc"),d("startTime","asc")):r=f(s,d("startDate","desc"),d("startTime","asc"),A(l));return(await D(r)).docs.map(n=>{const t=n.data();return{id:n.id,...t,hasStartStat:!!t.hasStartStat,hasEndStat:!!t.hasEndStat,_searchString:`${t.teamA||""} ${t.teamB||""} ${t.match||""} ${t.title||""} ${t.league||""} ${t.channel||""}`.toLowerCase()}})}catch(i){throw console.error("Error fetching matches:",i),i}},j=(a,o,e=!1)=>{const[c,l]=m.useState(500),s=C({queryKey:["matches",{dateFilter:a,dateRange:o,limit:c}],queryFn:I,placeholderData:T,staleTime:e?y.MATCHES_STALE_AUTO:y.MATCHES_STALE_DEFAULT,refetchInterval:e?y.MATCHES_AUTO:!1,refetchOnWindowFocus:e}),r=m.useMemo(()=>s.data||[],[s.data]),i=m.useMemo(()=>{if(!r.length)return[];const t={};for(const u of r){const h=u.startDate;t[h]||(t[h]=[]),t[h].push(u)}return Object.entries(t).sort((u,h)=>new Date(u[0])-new Date(h[0]))},[r]),n=()=>{o||l(t=>t+50)};return{matches:r,groupedData:i,loading:s.isLoading,isFetching:s.isFetching,loadMore:n,hasMore:!0,refetch:s.refetch}};export{N as F,b as M,Q as a,j as u};
