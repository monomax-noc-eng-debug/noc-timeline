import{d as k,r as h,q as g,k as w,i as b,v,x as z,o as D,f as j,b as S,u as M,j as e,L as E}from"./index-BFEWtwhJ.js";import{s as C}from"./incidentService-B6Q9IEZj.js";import{f as y}from"./format-DU8rxv2E.js";import{A}from"./activity-CgZXiaul.js";import{A as f}from"./arrow-right-Br0XfVuf.js";import{S as T}from"./shield-check-DlyofA7e.js";const I=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],L=k("calendar-days",I),G=()=>{const[u,r]=h.useState({incidents:{total:0,critical:0,open:0},matches:{total:0,live:0,upcoming:0},currentShift:{onDuty:[],status:"Normal",lastUpdate:null},loading:!0});return h.useEffect(()=>{const x=C(s=>{const t=s.filter(a=>a.status!=="Closed"&&a.status!=="Resolved"),o=t.filter(a=>a.priority==="Critical"||a.priority==="High").length;r(a=>({...a,incidents:{total:t.length,open:t.filter(i=>i.status==="Open").length,critical:o}}))},s=>console.error("Incidents Snapshot Error:",s)),m=y(new Date,"yyyy-MM-dd"),n=g(b(j,"schedules"),w("startDate","==",m)),c=v(n,s=>{const t=s.docs.map(i=>i.data()),o=new Date,a=t.filter(i=>{if(i.hasStartStat&&!i.hasEndStat)return!0;if(!i.startTime)return!1;try{const p=new Date(`${m}T${i.startTime}`),N=new Date(p.getTime()+7200*1e3);return o>=p&&o<=N}catch{return!1}}).length;r(i=>({...i,matches:{total:t.length,live:a,upcoming:Math.max(0,t.length-a)}}))},s=>console.error("Matches Snapshot Error:",s)),l=g(b(j,"shifts"),D("createdAt","desc"),z(1)),d=v(l,s=>{if(!s.empty){const t=s.docs[0].data();r(o=>({...o,currentShift:{onDuty:t.onDuty||[],status:t.status||"Normal",lastUpdate:t.updatedAt||t.createdAt}}))}},s=>console.error("Shift Snapshot Error:",s));return setTimeout(()=>{r(s=>({...s,loading:!1}))},500),()=>{typeof x=="function"&&x(),c&&c(),d&&d()}},[]),u};function Q(){const{currentUser:u}=S(),r=M(),[x,m]=h.useState(new Date),{incidents:n,matches:c,currentShift:l,loading:d}=G();h.useEffect(()=>{const t=setInterval(()=>m(new Date),6e4);return()=>clearInterval(t)},[]);const s=()=>{const t=x.getHours();return t<12?"Good Morning":t<18?"Good Afternoon":"Good Evening"};return e.jsxs("div",{className:"h-full flex flex-col items-center justify-center bg-zinc-50 dark:bg-black p-6 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-[#f0f4f8] dark:bg-black"}),e.jsxs("div",{className:"relative z-10 max-w-5xl w-full flex flex-col items-center gap-12 animate-in slide-in-from-bottom-8 fade-in duration-700",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 bg-[#0078D4] text-white rounded flex items-center justify-center font-bold text-lg shadow-sm",children:"N"}),e.jsx("div",{className:"inline-flex items-center px-3 py-1 rounded-full bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800",children:e.jsx("span",{className:"text-xs font-medium text-zinc-600 dark:text-zinc-400",children:y(x,"EEEE, dd MMMM yyyy")})})]}),e.jsxs("h1",{className:"text-3xl sm:text-4xl font-semibold text-zinc-900 dark:text-white tracking-tight",children:[s(),", ",e.jsx("span",{className:"text-[#0078D4]",children:u?.name?.split(" ")[0]||"Engineer"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 w-full px-4 sm:px-0",children:[e.jsx("div",{onClick:()=>r("/incidents"),className:"group relative bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg p-5 cursor-pointer hover:border-[#0078D4] hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex flex-col h-full justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-semibold text-zinc-700 dark:text-zinc-300",children:"Incidents"}),e.jsx("div",{className:"p-2 bg-red-50 dark:bg-red-900/20 rounded text-red-600 dark:text-red-400",children:e.jsx(A,{size:18})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold text-zinc-900 dark:text-white",children:[d?"-":n.open," Open"]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-zinc-500 mt-1",children:[n.critical>0&&e.jsxs("span",{className:"text-red-600 dark:text-red-400 font-semibold",children:[n.critical," Critical"]}),n.critical>0&&e.jsx("span",{className:"w-1 h-1 bg-zinc-300 rounded-full"}),e.jsxs("span",{children:[n.total," Total Active"]})]})]}),e.jsxs("div",{className:"flex items-center text-xs font-medium text-[#0078D4] opacity-0 group-hover:opacity-100 transition-opacity",children:["Manage Incidents ",e.jsx(f,{size:14,className:"ml-1"})]})]})}),e.jsx("div",{onClick:()=>r("/schedule/today"),className:"group relative bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg p-5 cursor-pointer hover:border-[#0078D4] hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex flex-col h-full justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-semibold text-zinc-700 dark:text-zinc-300",children:"Matches"}),e.jsx("div",{className:"p-2 bg-[#deecf9] dark:bg-[#0078D4]/20 rounded text-[#0078D4]",children:e.jsx(L,{size:18})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold text-zinc-900 dark:text-white",children:[d?"-":c.total," Today"]}),e.jsx("div",{className:"flex items-center gap-2 text-xs font-medium text-zinc-500 mt-1",children:c.live>0?e.jsxs("span",{className:"text-[#0078D4] font-semibold animate-pulse",children:[c.live," Live Now"]}):e.jsxs("span",{children:[c.upcoming," Upcoming"]})})]}),e.jsxs("div",{className:"flex items-center text-xs font-medium text-[#0078D4] opacity-0 group-hover:opacity-100 transition-opacity",children:["View Schedule ",e.jsx(f,{size:14,className:"ml-1"})]})]})}),e.jsx("div",{onClick:()=>r("/handover"),className:"group relative bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg p-5 cursor-pointer hover:border-[#0078D4] hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex flex-col h-full justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-semibold text-zinc-700 dark:text-zinc-300",children:"On Duty"}),e.jsx("div",{className:"p-2 bg-emerald-50 dark:bg-emerald-900/20 rounded text-emerald-600 dark:text-emerald-400",children:e.jsx(T,{size:18})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-zinc-900 dark:text-white line-clamp-1 mb-1",children:d?e.jsx(E,{className:"animate-spin text-zinc-400",size:20}):l.onDuty.length>0?l.onDuty.join(", "):"No Shift Logged"}),e.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-zinc-500",children:[e.jsx("span",{className:`inline-block w-2 h-2 rounded-full ${l.status==="Normal"?"bg-emerald-500":"bg-amber-500"}`}),e.jsxs("span",{children:["Status: ",l.status]})]})]}),e.jsxs("div",{className:"flex items-center text-xs font-medium text-[#0078D4] opacity-0 group-hover:opacity-100 transition-opacity",children:["Shift Handover ",e.jsx(f,{size:14,className:"ml-1"})]})]})})]})]})]})}export{Q as default};
