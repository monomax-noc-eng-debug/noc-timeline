import{c as k,r as g,H as y,j as e}from"./index-DK6B-WCw.js";import{u as z,Q as S}from"./useBaseQuery-BujZq4kw.js";import{c as D,d as I,q as f,o as p,w as h,l as E,j as O}from"./firebaseConfig-BlIlsXYa.js";import{i as M,f as L}from"./format-Xuj1Wk4j.js";import{C as T}from"./search-Bb0GrWoW.js";import{C as V}from"./clock-nIUUpKTM.js";import{P as $}from"./pencil-D_jbUahZ.js";import{T as C}from"./trash-2-Bo3QcrYj.js";import{a as F,T as q}from"./tv-loOJGcyQ.js";import{R as H}from"./radio-BWNKXV_r.js";import{E as w}from"./eye-CtiKWCb6.js";const P=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],re=k("eye-off",P);const U=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],_=k("timer",U);function B(t,c){return z(t,S)}const A=async({queryKey:t})=>{const[c,{dateFilter:i,dateRange:d,limit:b}]=t,l=D(I,"schedules");let x;if(i){let o=i;if(i instanceof Date)if(M(i))o=L(i,"yyyy-MM-dd");else return console.warn("Invalid Date Object passed to useMatches"),[];x=f(l,h("startDate","==",o),p("startTime","asc"))}else d?.start&&d?.end?x=f(l,h("startDate",">=",d.start),h("startDate","<=",d.end),p("startDate","asc"),p("startTime","asc")):x=f(l,p("startDate","desc"),p("startTime","asc"),E(b));return(await O(x)).docs.map(o=>{const a=o.data();return{id:o.id,...a,hasStartStat:!!a.hasStartStat,hasEndStat:!!a.hasEndStat,_searchString:`${a.teamA||""} ${a.teamB||""} ${a.match||""} ${a.title||""} ${a.league||""} ${a.startDate||""}`.toLowerCase()}})},ne=(t,c,i=!0)=>{const[d,b]=g.useState(100),{data:l=[],isLoading:x,isFetching:s,refetch:o}=B({queryKey:["matches",{dateFilter:t,dateRange:c,limit:d}],queryFn:A,placeholderData:y,staleTime:1e3*60*5,gcTime:1e3*60*30,enabled:i}),a=g.useMemo(()=>{if(l.length===0)return[];const n={};for(const u of l){const m=u.startDate;n[m]||(n[m]=[]),n[m].push(u)}return Object.entries(n).sort((u,m)=>new Date(u[0])-new Date(m[0]))},[l]);return{matches:l,groupedData:a,loading:x,isFetching:s,loadMore:()=>{!t&&!c&&b(n=>n+50)},hasMore:!0,refetch:o}},Q=g.memo(({match:t,onClick:c,onEdit:i,onDelete:d,selectable:b,selected:l,onSelect:x})=>{const s=g.useMemo(()=>{if(t.isLiveTime)return"LIVE";if(t.statusDisplay?.includes("Finished"))return"FINISHED";if(t.countdown&&t.countdown.toString().includes("m"))return"SOON";if(t.hasEndStat)return"FINISHED";if(t.hasStartStat&&!t.hasEndStat)return"LIVE";if(t.startTime&&t.startDate){const r=new Date,n=r.toLocaleDateString("en-CA");if(t.startDate===n){const[m,v]=t.startTime.split(":").map(Number),N=new Date;N.setHours(m,v,0,0);const j=(N-r)/(1e3*60);if(j>0&&j<=15)return"SOON"}}return"UPCOMING"},[t]),o=g.useMemo(()=>t.endStats?.muxViewerUniq?t.endStats.muxViewerUniq:t.startStats?.muxViewerUniq?t.startStats.muxViewerUniq:0,[t.endStats,t.startStats]),a=r=>{if(!r)return"0";const n=parseFloat(r.toString().replace(/,/g,""));return isNaN(n)?r:Intl.NumberFormat("en-US",{notation:"compact",maximumFractionDigits:1}).format(n)};return e.jsxs("div",{onClick:c,className:`
        group relative bg-white dark:bg-zinc-900 rounded-2xl border-2 transition-all duration-300 
        hover:shadow-2xl hover:scale-[1.02] cursor-pointer overflow-hidden
        ${s==="LIVE"?"border-red-500 shadow-lg shadow-red-500/20":""}
        ${s==="SOON"?"border-orange-400 shadow-lg shadow-orange-500/10":""}
        ${s==="FINISHED"?"border-emerald-500/30 dark:border-emerald-500/20":""}
        ${s==="UPCOMING"?"border-zinc-200 dark:border-zinc-800":""}
      `,children:[e.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-1.5 ${s==="LIVE"?"bg-red-500 animate-pulse":s==="SOON"?"bg-orange-500":s==="FINISHED"?"bg-emerald-500":"bg-zinc-300 dark:bg-zinc-700"}`}),(s==="LIVE"||s==="SOON")&&e.jsx("div",{className:`absolute inset-0 bg-gradient-to-r pointer-events-none ${s==="LIVE"?"from-red-500/5 via-orange-500/5":"from-orange-500/5 via-yellow-500/5"} to-transparent`}),e.jsxs("div",{className:"p-6 pl-8 relative",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s==="LIVE"&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-red-500 text-white rounded-lg shadow-lg shadow-red-500/30",children:[e.jsxs("span",{className:"relative flex h-2.5 w-2.5",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-white opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-2.5 w-2.5 bg-white"})]}),e.jsx("span",{className:"text-xs font-black uppercase tracking-wider",children:"LIVE"})]}),s==="SOON"&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-orange-500 text-white rounded-lg shadow-md shadow-orange-500/20 animate-pulse",children:[e.jsx(_,{size:14,className:"stroke-[3]"}),e.jsx("span",{className:"text-xs font-black uppercase tracking-wider",children:t.countdown&&t.countdown.includes("m")?`Starts in ${t.countdown}`:"Starting Soon"})]}),s==="FINISHED"&&e.jsxs("div",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-emerald-500 text-white rounded-lg shadow-md",children:[e.jsx(T,{size:14}),e.jsx("span",{className:"text-xs font-black uppercase tracking-wider",children:"Finished"})]}),s==="UPCOMING"&&e.jsxs("div",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 rounded-lg border-2 border-blue-200 dark:border-blue-800",children:[e.jsx(V,{size:14}),e.jsx("span",{className:"text-xs font-black uppercase tracking-wider",children:"Scheduled"})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 opacity-0 group-hover:opacity-100 transition-opacity",children:[i&&e.jsx("button",{onClick:r=>{r.stopPropagation(),i(t)},className:"p-2 rounded-lg bg-zinc-100 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-400 hover:bg-blue-50 hover:text-blue-600 dark:hover:bg-blue-900/30 dark:hover:text-blue-400 transition-colors",title:"Edit",children:e.jsx($,{size:14})}),d&&e.jsx("button",{onClick:r=>{r.stopPropagation(),d(t.id)},className:"p-2 rounded-lg bg-zinc-100 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-400 hover:bg-red-50 hover:text-red-600 dark:hover:bg-red-900/30 dark:hover:text-red-400 transition-colors",title:"Delete",children:e.jsx(C,{size:14})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[t.league&&e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-zinc-500 dark:text-zinc-400",children:[e.jsx(F,{size:12,className:"text-zinc-400"}),e.jsx("span",{className:"font-semibold",children:t.league})]}),t.channel&&e.jsxs("div",{className:"flex items-center gap-1 px-2 py-0.5 bg-indigo-50 dark:bg-indigo-900/20 text-indigo-600 dark:text-indigo-400 rounded text-xs font-bold border border-indigo-100 dark:border-indigo-800",children:[e.jsx(q,{size:10}),t.channel]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`shrink-0 flex flex-col items-center justify-center w-16 h-16 rounded-xl border transition-colors ${s==="SOON"?"bg-orange-50 dark:bg-orange-900/10 border-orange-200 dark:border-orange-800":"bg-zinc-100 dark:bg-zinc-800/50 border-zinc-200 dark:border-zinc-700"}`,children:s==="LIVE"?e.jsxs(e.Fragment,{children:[e.jsx(H,{size:16,className:"text-red-500 mb-1 animate-pulse"}),e.jsx("span",{className:"text-[10px] font-black text-red-500 uppercase",children:"Live"})]}):s==="SOON"&&t.countdown&&t.countdown.includes("m")?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-xl font-black font-mono leading-none text-orange-500",children:t.countdown.replace("m","")}),e.jsx("span",{className:"text-[10px] font-bold text-orange-400 uppercase",children:"mins"})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:`text-xl font-black font-mono leading-none ${s==="SOON"?"text-orange-500":"text-zinc-900 dark:text-white"}`,children:t.startTime?.split(":")[0]||"--"}),e.jsx("span",{className:`text-xs font-mono ${s==="SOON"?"text-orange-400":"text-zinc-400"}`,children:t.startTime?.split(":")[1]||"--"})]})}),e.jsx("div",{className:"flex-1 min-w-0",children:t.teamA&&t.teamB?e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-base font-black text-zinc-900 dark:text-white truncate",children:t.teamA}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-px flex-1 bg-zinc-200 dark:bg-zinc-700"}),e.jsx("span",{className:"text-xs font-bold text-zinc-400",children:"VS"}),e.jsx("div",{className:"h-px flex-1 bg-zinc-200 dark:bg-zinc-700"})]}),e.jsx("div",{className:"text-base font-black text-zinc-900 dark:text-white truncate",children:t.teamB})]}):e.jsx("div",{className:"text-base font-black text-zinc-900 dark:text-white truncate",children:t.title||t.match||"Match Event"})})]}),(s==="LIVE"||s==="FINISHED")&&o>0&&e.jsx("div",{className:"flex items-center gap-2 pt-2 border-t border-zinc-100 dark:border-zinc-800",children:e.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-1.5 bg-zinc-50 dark:bg-zinc-800/50 rounded-lg text-xs font-semibold text-zinc-600 dark:text-zinc-400",children:[e.jsx(w,{size:14,className:"text-violet-500"}),e.jsxs("span",{children:[a(o)," Viewers"]})]})})]})]}),e.jsx("button",{onClick:c,className:"absolute bottom-4 right-4 p-2 rounded-lg bg-zinc-900 dark:bg-white text-white dark:text-black opacity-0 group-hover:opacity-100 transition-opacity shadow-lg",title:"View Details",children:e.jsx(w,{size:16})})]})});Q.displayName="MatchCard";export{re as E,Q as M,_ as T,ne as u};
