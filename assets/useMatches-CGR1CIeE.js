import{d as T,r as l,O as M}from"./index-MAGVuFXp.js";import{c as p,t as E,l as A,i as D,f as _}from"./format-DwWD4j_p.js";import{i as L}from"./parseISO-C1wERBSI.js";import{u as g,Q as H}from"./useBaseQuery-mzdAQ7XD.js";import{c as w,d as F,q as f,w as y,a as u,l as O,m as k}from"./firebaseConfig-ZmQab4ju.js";const C=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],B=T("file-spreadsheet",C);function q(t,s){return g(t,H)}function I(t,s,a){return p(t,+E(t)+s)}function R(t,s,a){return I(t,s*A)}function U(t){return p(t,Date.now())}function V(t,s){return L(p(t,t),U(t))}const S={MATCHES_AUTO:1e3*30,MATCHES_STALE_AUTO:1e3*20,MATCHES_STALE_DEFAULT:1e3*60*5},j={SOON_MINUTES:15},v=async({queryKey:t})=>{const[s,{dateFilter:a,dateRange:i,limit:m}]=t,r=w(F,"schedules");let o;try{if(a){let n=a;if(a instanceof Date)if(D(a))n=_(a,"yyyy-MM-dd");else return[];o=f(r,y("startDate","==",n),u("startTime","asc"))}else i?.start&&i?.end?o=f(r,y("startDate",">=",i.start),y("startDate","<=",i.end),u("startDate","asc"),u("startTime","asc")):o=f(r,u("startDate","desc"),u("startTime","asc"),O(m));return(await k(o)).docs.map(n=>{const e=n.data();return{id:n.id,...e,hasStartStat:!!e.hasStartStat,hasEndStat:!!e.hasEndStat,_searchString:`${e.teamA||""} ${e.teamB||""} ${e.match||""} ${e.title||""} ${e.league||""} ${e.channel||""}`.toLowerCase()}})}catch(c){throw console.error("Error fetching matches:",c),c}},x=(t,s,a=!1)=>{const[i,m]=l.useState(500),r=q({queryKey:["matches",{dateFilter:t,dateRange:s,limit:i}],queryFn:v,placeholderData:M,staleTime:a?S.MATCHES_STALE_AUTO:S.MATCHES_STALE_DEFAULT,refetchInterval:a?S.MATCHES_AUTO:!1,refetchOnWindowFocus:a}),o=l.useMemo(()=>r.data||[],[r.data]),c=l.useMemo(()=>{if(!o.length)return[];const e={};for(const d of o){const h=d.startDate;e[h]||(e[h]=[]),e[h].push(d)}return Object.entries(e).sort((d,h)=>new Date(d[0])-new Date(h[0]))},[o]),n=()=>{s||m(e=>e+50)};return{matches:o,groupedData:c,loading:r.isLoading,isFetching:r.isFetching,loadMore:n,hasMore:!0,refetch:r.refetch}};export{B as F,j as M,R as a,V as i,x as u};
