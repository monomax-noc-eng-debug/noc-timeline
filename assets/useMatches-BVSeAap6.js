import{d as y,r as l,O as M,g as A,h as p,q as S,w as f,o as h,v as E,i as _}from"./index-C3czKcPY.js";import{u as D,Q as L}from"./useBaseQuery-C-SPIq1p.js";import{k as g,a as O}from"./format-DPgh7KlH.js";const H=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],q=y("file-spreadsheet",H);function k(c,d){return D(c,L)}const T={MATCHES_AUTO:1e3*30,MATCHES_STALE_AUTO:1e3*20,MATCHES_STALE_DEFAULT:1e3*60*5},v={SOON_MINUTES:15,MATCH_DURATION_HOURS:2.5},C=async({queryKey:c})=>{const[d,{dateFilter:e,dateRange:o,limit:m}]=c,a=A(p,"schedules");let s;try{if(e){let r=e;if(e instanceof Date)if(g(e))r=O(e,"yyyy-MM-dd");else return[];s=S(a,f("startDate","==",r),h("startTime","asc"))}else o?.start&&o?.end?s=S(a,f("startDate",">=",o.start),f("startDate","<=",o.end),h("startDate","asc"),h("startTime","asc")):s=S(a,h("startDate","desc"),h("startTime","asc"),E(m));return(await _(s)).docs.map(r=>{const t=r.data();return{id:r.id,...t,hasStartStat:!!t.hasStartStat,hasEndStat:!!t.hasEndStat,_searchString:`${t.teamA||""} ${t.teamB||""} ${t.match||""} ${t.title||""} ${t.league||""} ${t.channel||""}`.toLowerCase()}})}catch(n){throw console.error("Error fetching matches:",n),n}},I=(c,d,e=!1)=>{const[o,m]=l.useState(500),a=k({queryKey:["matches",{dateFilter:c,dateRange:d,limit:o}],queryFn:C,placeholderData:M,staleTime:e?T.MATCHES_STALE_AUTO:T.MATCHES_STALE_DEFAULT,refetchInterval:e?T.MATCHES_AUTO:!1,refetchOnWindowFocus:e}),s=l.useMemo(()=>a.data||[],[a.data]),n=l.useMemo(()=>{if(!s.length)return[];const t={};for(const u of s){const i=u.startDate;t[i]||(t[i]=[]),t[i].push(u)}return Object.entries(t).sort((u,i)=>new Date(u[0])-new Date(i[0]))},[s]),r=()=>{d||m(t=>t+50)};return{matches:s,groupedData:n,loading:a.isLoading,isFetching:a.isFetching,loadMore:r,hasMore:!0,refetch:a.refetch}};export{q as F,v as M,I as u};
